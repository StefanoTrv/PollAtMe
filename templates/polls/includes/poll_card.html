<div class="card mb-3" style="text-align:center">
    {% if poll.is_active %}
    <span class="badge rounded-pill position-absolute top-0 start-50 translate-middle bg-success">
        Votazione in corso
    </span>
    {% elif poll.is_ended %}
    <span class="badge rounded-pill position-absolute top-0 start-50 translate-middle bg-danger">
        Votazione conclusa
    </span>
    {% elif poll.is_not_started %}
    <span class="badge rounded-pill position-absolute top-0 start-50 translate-middle bg-warning">
        Votazione non avviata
    </span>
    {% endif %}
    <img class="img-fluid card-img-top" src="https://appsrv1-147a1.kxcdn.com/gradient/images/slider/img-slide-3.jpg" alt="Card Image cap">
    <div class="card-body">
        <h5 class="card-title"> {{ poll.title }} </h6>
        <p class="card-subtitle mb-2 text-muted">
            {% if poll.is_not_started %} Parte il {{ poll.start | date:"d/m/Y, H:i" }} {% endif %}
            {% if poll.is_active %} Termina il {{ poll.end | date:"d/m/Y, H:i" }} {% endif %}
            {% if poll.is_ended %} Terminato il {{ poll.end | date:"d/m/Y, H:i" }} {% endif %}
        </p>
        {% if poll.is_active %}
        <a class="btn btn-block btn-primary mb-4" href={% url  'polls:vote' id=poll.id %}>
            {% if poll.default_type == 1 %}
                Giudica
            {% elif poll.default_type == 3 %}
                Scegli
            {% endif %}
        </a>
        {% endif %}
        
        {% if poll.is_active or poll.is_ended %}
            <a class="btn btn-block btn-secondary mb-4" href={% url 'polls:result' id=poll.id %}>Risultati</a>      
        {% endif %}

        {% if poll.is_not_started and  user.is_authenticated  and user == poll.author %}
        <a class="btn btn-block btn-warning mb-4" href={% url 'polls:edit_poll' id=poll.id %}>
            Modifica
        </a>
        <button type="button" class="btn btn-block btn-danger mb-4" data-bs-toggle="modal" data-bs-target="#modalDeletePollConfirm" data-bs-poll="{{ poll.id }}">
            Cancella
        </button>
        {% endif %}

        <a class="btn btn-block btn-primary mb-4" data-bs-toggle="modal" data-bs-target="#modalPollSharing" data-bs-code="{{ poll.mapping_set.first }}" data-bs-public="{{ poll.is_public }}" data-bs-title="{{ poll.title }}" data-bs-end="{{ poll.end | date:"d/m/Y, H:i" }}"> 
            <em class="feather mr-2 icon-share-2"></em>
        </a>
    </div>
</div>

{% include 'polls/includes/modal_spiegazione_giudizio_maggioritario.html'%}